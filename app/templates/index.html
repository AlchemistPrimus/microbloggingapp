{%extends "base.html"%}
{%import "bootstrap/wtf.html" as wtf%}
{%import "_macros.html" as macros%}




{%block content%}
    <div class="container MainIndex">
        {%if current_user.is_authenticated%}
        <div class="IndexProfile">
            <div class="profile-thumbnail">
                <a href="{{ url_for('main.user', username=current_user.username) }}"><img class="img-circle profile-thumbnail" src="{{current_user.gravatar(size=50) }}"></a>
            </div>
            <b><a href="{{url_for('main.user',username=current_user.username)}}">{{current_user.username}}</a></b>

            <a href="{{ url_for('main.followers', username=current_user.username) }}">Followers: <span class="badge">{{ current_user.followers.count()-1 }}</span>
            </a>
            <a href="{{ url_for('main.followed_by', username=current_user.username) }}">Following: <span class="badge">{{ current_user.followed.count() -1 }}</span>
            </a>
        </div>
        {%else%}
            <p>Hello, this is the first place to visit before buying a product. See reviews and what other users say about the product. Grab the best deals and the best products available. Make good use of your money.</p>
        {%endif%}
        <div class="IndexInput">
            {% if not current_user.can(Permission.WRITE) %}
            {{ wtf.quick_form(form) }}
            {% endif %}
        </div>
    </div>
    
    
    <div class="post-tabs">
        <ul class="nav nav-tabs">
            <li{% if not show_followed %} class="active"{% endif %}><a href="{{ url_for('main.show_all') }}">All</a></li>
            {% if current_user.is_authenticated %}
            <li{% if show_followed %} class="active"{% endif %}><a href="{{ url_for('main.show_followed') }}">Followed</a></li>
            {% endif %}
        </ul>
        {% include '_posts.html' %}
        {% if pagination %}
        <div class="pagination">
            {{ macros.pagination_widget(pagination, 'main.home') }}
        </div>
        {% endif %}
    </div>
    {{super()}}
{% endblock %}

{% block scripts %}
{{ super() }}
{{ pagedown.include_pagedown() }}
{% endblock %}